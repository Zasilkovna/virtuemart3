<?xml version="1.0" encoding="utf-8"?>
<extension version="3.0" type="plugin" method="upgrade" group="vmshipment">
    <!--  The extension commercial name: make it different form others at JED http://extensions.joomla.org/-->
    <name>Zasilkovna VM3</name>
    <!-- The following elements are optional and free of formatting constraints -->
    <!-- Original creation date. Recommended: YYYY-MM-DD -->
    <creationDate>2015-04-20</creationDate>
    <author>Zásilkovna s.r.o.</author>
    <authorEmail>technicka.podpora@zasilkovna.cz</authorEmail>
    <authorUrl>http://www.zasilkovna.cz/</authorUrl>
    <copyright>(c) 2021 Zásilkovna s.r.o.</copyright>
    <license>License Info with link</license>
    <!--  The version string is recorded in the components table -->
    <version>1.4.0</version>
    <!--  The date for the actual version release -->
    <releaseDate>2021-06-29</releaseDate>
    <!--  Type of release: Bug fix, Security Fix, Minor update, Major update -->
    <releaseType>Major update</releaseType>
    <!-- The description is optional and defaults to the name -->
    <description>Zasilkovna.cz VM3 shipment plugin</description>

    <scriptfile>install.zasilkovna.php</scriptfile>
    <installfile>install.zasilkovna.php</installfile>
    <files>
        <filename plugin="zasilkovna">zasilkovna.php</filename>
        <filename plugin="zasilkovna">install.sql</filename>
    </files>
    <config>

    </config>
    <vmconfig>
        <fields name="params">
            <fieldset name="global" addrulepath="components/com_zasilkovna/models/rules">
                <field name="shipping_type" type="radio" default="pickuppoints"
                       required="true"
                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_SHIPPING_TYPE"
                       description="PLG_VMSHIPMENT_PACKETERY_CONFIG_SHIPPING_TYPE_DESCRIPTION">
                    <option value="pickuppoints">PLG_VMSHIPMENT_PACKETERY_CONFIG_PICKUP_POINTS</option>
                    <option value="hdcarriers">PLG_VMSHIPMENT_PACKETERY_CONFIG_TO_HD</option>
                </field>
                <field name="hd_carrier"
                       type="vmzasilkovnahdcarriers"
                       showon="shipping_type:hdcarriers"
                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_CARRIER"
                       required="true"
                       validate="carrier"/>

                <field name="maxWeight" type="number" step="0.001" label="PLG_VMSHIPMENT_PACKETERY_CONFIG_MAX_WEIGHT"
                       required="true"
                       description="PLG_VMSHIPMENT_PACKETERY_CONFIG_MAX_WEIGHT_LABEL" default="10"/>

                <field name="shipment_cost" type="number" step="0.01"
                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_DEFAULT_PRICE" required="true"
                       description="PLG_VMSHIPMENT_PACKETERY_CONFIG_DEFAULT_PRICE_LABEL" default="100"/>

                <field name="free_shipment" type="number" step="0.01"
                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_FREE_SHIPPING"
                       description="PLG_VMSHIPMENT_PACKETERY_CONFIG_FREE_SHIPPING_LABEL" default=""/>

                <field name="tax_id" type="vmtaxes" scope="com_virtuemart" label="VMSHIPMENT_WEIGHT_COUNTRIES_TAX"
                       description="VMSHIPMENT_WEIGHT_COUNTRIES_TAX_DESC" default="0"/>

                <field
                        name="globalWeightRules"
                        type="subform"
                        label="PLG_VMSHIPMENT_PACKETERY_GLOBAL_WEIGHT_RULES"
                        description="PLG_VMSHIPMENT_PACKETERY_GLOBAL_WEIGHT_RULES_LABEL"
                        multiple="true"
                        min="0">
                    <form>
                        <field name="maxWeightKg" type="number" step="0.001"
                               label="PLG_VMSHIPMENT_PACKETERY_CONFIG_WEIGHT_TO"
                               size="30" required="true"/>

                        <field name="price" type="number" step="0.01"
                               label="PLG_VMSHIPMENT_PACKETERY_CONFIG_PRICE"
                               size="30" required="true"/>
                    </form>
                </field>
            </fieldset>

            <fieldset name="restrictions">
                <field name="checkConditionsCore" value="1" default="1" type="hidden"/>
                <field
                        name="pricingRules"
                        class="packetery-pricing-rules"
                        type="subform"
                        label="PLG_VMSHIPMENT_PACKETERY_PRICING_RULES"
                        description="PLG_VMSHIPMENT_PACKETERY_PRICING_RULES_LABEL"
                        multiple="true"
                        min="0">
                    <form>
                        <field name="country" type="vmzasilkovnacountries" label="PLG_VMSHIPMENT_PACKETERY_COUNTRY"
                               required="true"/>

                        <field name="shipment_cost" type="number" step="0.01"
                               label="PLG_VMSHIPMENT_PACKETERY_CONFIG_DEFAULT_PRICE" required="false"
                               description="PLG_VMSHIPMENT_PACKETERY_CONFIG_DEFAULT_PRICE_LABEL" default=""/>

                        <field name="free_shipment" type="number" step="0.01"
                               label="PLG_VMSHIPMENT_PACKETERY_CONFIG_FREE_SHIPPING"
                               description="PLG_VMSHIPMENT_PACKETERY_CONFIG_FREE_SHIPPING_LABEL" default=""/>

                        <field
                                name="weightRules"
                                type="subform"
                                label="PLG_VMSHIPMENT_PACKETERY_WEIGHT_RULES"
                                description="PLG_VMSHIPMENT_PACKETERY_WEIGHT_RULES_LABEL"
                                multiple="true"
                                min="0">
                            <form>
                                <field name="maxWeightKg" type="number" step="0.001"
                                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_WEIGHT_TO"
                                       size="30" required="true"/>

                                <field name="price" type="number" step="0.01"
                                       label="PLG_VMSHIPMENT_PACKETERY_CONFIG_PRICE"
                                       size="30" required="true"/>
                            </form>
                        </field>
                    </form>
                </field>
            </fieldset>
        </fields>
    </vmconfig>

    <media folder="media" destination="com_zasilkovna">
        <folder>admin</folder>
        <folder>media</folder>
    </media>
</extension>
